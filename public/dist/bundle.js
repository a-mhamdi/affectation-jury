(()=>{"use strict";function e(e){document.getElementById("popupJury"+e).style.display="block",async function(e){try{const t=await fetch("/api/getJury");if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const n=await t.json(),r="selectJury"+e,o=document.getElementById(r);if(o.innerHTML="",0===n.length){console.log("No choices found");const e=document.createElement("option");e.textContent="No choices available",o.appendChild(e)}else{const e=document.createElement("option");e.value="Indéfini",e.textContent="-> SÉLECTIONNEZ <-",o.appendChild(e),n.forEach((e=>{const t=document.createElement("option");t.value=e.name||e._id,t.textContent=e.name,o.appendChild(t)}))}}catch(e){console.error("Error fetching choices:",e)}}(e)}const t={jury1:"UNDEF",jury2:"UNDEF"};async function n(e){const n=document.getElementById("selectJury"+e).value;1===e?(t.jury1=n,jury1.innerHTML=n):(t.jury2=n,jury2.innerHTML=n),document.getElementById("popupJury"+e).style.display="none"}let r=null,o=null,c=null;document.querySelector("#openJury1").addEventListener("click",(function(t){e(1)})),document.querySelector("#saveJury1").addEventListener("click",(function(e){n(1)})),document.querySelector("#openJury2").addEventListener("click",(function(t){e(2)})),document.querySelector("#saveJury2").addEventListener("click",(function(e){n(2)})),document.getElementById("searchButton").addEventListener("click",(function(){const e=document.getElementById("searchIdentifiant").value;fetch(`/api/data?identifiant=${encodeURIComponent(e)}`).then((e=>e.json())).then((e=>{const t=document.getElementById("result");e.length>0?(t.innerHTML="",etudiant.innerHTML=e[0].name,o=e[0].initiation,c=e[0].perfectionnement,r=e[0]._id):(alert("Aucun(e) étudiant(e) trouvé(e)"),t.innerHTML="Aucun(e) étudiant(e) trouvé(e).",t.style.display="block")})).catch((e=>{console.error("Error:",e),alert("Erreur lors de la recherche d'un étudiant.")}))})),document.getElementById("submitBtn").addEventListener("click",(function(){if(r)try{if(!o||void 0===o.score||o.score<10)var e={jury1:t.jury1,jury2:t.jury2};else{if(c&&void 0!==c.score&&!(c.score<10))return alert("Document verrouillé."),void console.log("Value is valid, aborting...");var n={jury1:t.jury1,jury2:t.jury2}}const u={juryinit:e,juryperf:n};console.log("Updated jury:",u),fetch(`/api/data/${r}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)}).then((e=>{if(!e.ok)throw new Error("Network response was NOK.");return e.json()})).then((e=>{alert(e.msg)})).catch((e=>{console.error("Error:",e),alert("Erreur lors de l'enregistrement des données.")}))}catch(e){}else alert("Veuillez d'abord rechercher un étudiant.")}))})();